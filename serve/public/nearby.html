<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>衣佳服装附近</title>
    <link rel='stylesheet' href='./css/mui.min.css'>
    <link rel='stylesheet' href='./css/app.css'>
    <script src='./js/flexible.js'></script>
    <script src='./js/mui.js'></script>
    <script src='./js/jquery-3.2.1.js'></script>
</head>

<body>
<div id="app">
    <header class="mui-bar mui-bar-nav mui-bar-transparent" data-top='0' data-offset='150' data-duration='16'
            data-scrollby=".mui-scroll-wrapper">
        <a class='BtnLeft' href='javascript:'>深圳</a>
        <h3 class='mui-title AllTitle'>附近</h3>
        <a class='BtnRight ripple' href='javascript:'><img src='./img/search.png' alt=''></a>
    </header>
    <section class='IndexPage'>
        <div id="pullrefresh" class="mui-content mui-scroll-wrapper">
            <div class="mui-scroll HomeSection">
                <!--数据列表-->
                <ul class="mui-table-view mui-table-view-chevron">
                </ul>
            </div>
        </div>
    </section>
    <footer></footer>
</div>
<script>
    $.ajax({
        url: './common/footer.html',
        type: "GET",
        success: function (res) {
            $(res).replaceAll('footer');
            var $dom = $('nav .mui-tab-item:nth-child(2)');
            $dom.addClass('mui-active').children('img').attr('src', './img/shape_choose.png');
        }
    });

    let options = {
        scrollY: true, //是否竖向滚动
        scrollX: false, //是否横向滚动
        startX: 0, //初始化时滚动至x
        startY: 0, //初始化时滚动至y
        indicators: true, //是否显示滚动条
        deceleration: 0.0006, //阻尼系数,系数越小滑动越灵敏
        bounce: true //是否启用回弹
    }
    mui('body').on('click', 'a', function () {
        document.location.href = this.href;
    });
    mui('.mui-scroll-wrapper').scroll(options);
    mui.init({
        pullRefresh: {
            container: '#pullrefresh',
            down: {
                style: 'circle',
                callback: pulldownRefresh
            },
            up: {
                auto: true,
                contentrefresh: '正在加载...',
                callback: pullupRefresh
            }
        }
    });
    var count = 0;

    /*上拉*/
    function pullupRefresh() {
        setTimeout(function () {
            mui('#pullrefresh').pullRefresh().endPullupToRefresh((++count > 2)); //参数为true代表没有更多数据了。
            var html = $('#pullrefresh .mui-table-view').html()
            html +=
                `<li class="mui-table-view-cell">
                    <a href="javascript:">
                    <div class='ShopAvatar'><img src='./img/all_pro.png' alt=''></div>
                    <div class='ShopDetail'>
                        <p>左岸咖啡</p>
                        <p class="HomeStar">
                            <img src="./img/assase_06.png" alt="">
                            <img src="./img/assase_06.png" alt="">
                            <img src="./img/assase_06.png" alt="">
                            <img src="./img/assase_06.png" alt="">
                            <img src="./img/assess_03.png" alt="">
                        </p>
                        <div class='handleBtn'>
                            <span>下午茶</span>
                            <span>开啡</span>
                        </div>
                    </div>
                    </a>
                </li>`;
            $('#pullrefresh .mui-table-view').html(html);
        }, 1500);
    }

    /*下拉*/
    function pulldownRefresh() {
        setTimeout(function () {
            mui('#pullrefresh').pullRefresh().endPulldownToRefresh();
        }, 1500);
    }
</script>
</body>

</html>
